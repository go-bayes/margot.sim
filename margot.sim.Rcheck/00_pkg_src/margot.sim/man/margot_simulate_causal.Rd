% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/margot-simulate-causal.R
\name{margot_simulate_causal}
\alias{margot_simulate_causal}
\title{Simulate data for causal inference with proper censoring}
\usage{
margot_simulate_causal(
  n,
  waves,
  treatments,
  interventions,
  sampling_weights = NULL,
  apply_censoring = FALSE,
  use_process_function = TRUE,
  common_params = list(),
  ...
)
}
\arguments{
\item{n}{Integer. Number of subjects to simulate}

\item{waves}{Integer. Number of measurement waves}

\item{treatments}{Character vector or list. Names of treatment variables. Can be:
- Single treatment: "a" (backward compatible)
- Multiple treatments: c("a", "b")
- Named list: list(belief_god = "believe_god", belief_spirit = "believe_spirit")}

\item{interventions}{Named list of intervention functions. Each function should
have signature function(data, time, trt) and return treatment values}

\item{sampling_weights}{Weights or function to create target population}

\item{apply_censoring}{Logical. Apply censoring to create observed data?}

\item{use_process_function}{Logical. Use margot_process_longitudinal?}

\item{common_params}{List with elements:
- params: Parameters for margot_simulate
- censoring_params: Censoring parameters
- verbose: Print progress?}

\item{...}{Additional arguments passed to margot_simulate}
}
\value{
Object of class "margot_causal_sim" containing:
  - data: List of datasets under each intervention
  - data_true: Complete data before any shadows (if shadows applied)
  - data_observed: Data after shadows applied (if shadows applied)
  - effects: True causal effects (if multiple interventions)
  - effects_true: Effects computed from true data
  - effects_observed: Effects computed from observed data
  - censoring_bias: Bias induced by censoring (if apply_censoring = TRUE)
  - metadata: Simulation metadata
}
\description{
Wrapper function that simulates data under multiple intervention regimes
for causal inference. Supports:
- Multiple treatment strategies
- Sampling weights for target populations
- Post-hoc censoring to create realistic observed data
- Automatic computation of true causal effects
- Bias analysis from censoring
}
\examples{
# Example 1: Single treatment (backward compatible)
interventions <- list(
  never_treat = function(data, time, trt) {
    rep(0, nrow(data))
  },
  always_treat = function(data, time, trt) {
    rep(1, nrow(data))
  },
  natural = function(data, time, trt) {
    data[[trt]]  # return natural treatment
  }
)

# Simulate with censoring
results <- margot_simulate_causal(
  n = 1000,
  waves = 3,
  treatments = "a",
  interventions = interventions,
  apply_censoring = TRUE,
  common_params = list(
    params = list(a_lag_y_coef = 0.3),
    verbose = TRUE
  )
)

# Example 2: Multi-treatment with interaction patterns
# Use the new interaction shift functions
interaction_interventions <- list(
  both_high = create_interaction_patterns(
    trt_patterns = list("belief_god" = 1, "belief_spirit" = 1),
    combination = "all"
  ),
  only_god = create_interaction_patterns(
    trt_patterns = list("belief_god" = 1, "belief_spirit" = 0),
    combination = "all"
  ),
  only_spirit = create_interaction_patterns(
    trt_patterns = list("belief_god" = 0, "belief_spirit" = 1),
    combination = "all"
  ),
  neither = create_interaction_patterns(
    trt_patterns = list("belief_god" = 0, "belief_spirit" = 0),
    combination = "all"
  )
)

\dontrun{
# Simulate multi-treatment scenario
multi_results <- margot_simulate_causal(
  n = 1000,
  waves = 3,
  treatments = c("belief_god", "belief_spirit"),
  interventions = interaction_interventions,
  apply_censoring = FALSE
)
}

}
